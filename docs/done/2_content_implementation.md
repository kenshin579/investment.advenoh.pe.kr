# 콘텐츠 목차 스타일 통일 - 구현 문서

## 1. 구현 전략

### 1.1 접근 방식

93개 파일을 **카테고리별로 순차 처리**한다. 각 파일마다:

1. frontmatter 영역과 코드 블록 영역을 식별하여 보호
2. heading 라인만 추출하여 레벨 승격 + 번호 체계 재부여
3. 수정 후 UTF-8 인코딩 검증

### 1.2 파일별 처리 유형

| 유형 | 설명 | 처리 방법 |
|------|------|-----------|
| **A. 번호 있는 파일** | `## 1.`, `### 2.1` 등 이미 번호가 있는 파일 | heading 레벨만 한 단계 승격, 기존 번호 유지 |
| **B. 번호 없는 파일** | `## CMA란?`, `### 특징` 등 번호 없음 | heading 레벨 승격 + 번호 부여 |
| **C. 혼합 파일** | 일부는 번호 있고 일부는 없음 | 파일 단위로 판단하여 처리 |
| **D. 이미 H1 시작 파일** | `# 1. 개요`로 시작 (etf 일부) | 번호 체계만 점검, 레벨 변경 불필요 |

---

## 2. 변환 규칙 상세

### 2.1 heading 레벨 승격

frontmatter 아래에서 최상위 heading 레벨을 판별한 후 처리:

- **최상위가 `##`(H2)인 경우**: 모든 heading을 한 단계 승격
  - `##` → `#`, `###` → `##`, `####` → `###`, `#####` → `####`
- **최상위가 `#`(H1)인 경우**: 레벨 변경 없음 (번호 체계만 점검)

### 2.2 번호 부여 규칙

- `#`(H1): 순차 정수 — `# 1.`, `# 2.`, `# 3.` ...
- `##`(H2): 상위 H1 번호 + 하위 순번 — `## 1.1`, `## 1.2`, `## 2.1` ...
- `###`(H3): 상위 H2 번호 + 하위 순번 — `### 1.1.1`, `### 1.1.2` ...
- 기존에 번호가 있으면 유지, 없으면 새로 부여

### 2.3 코드 블록 보호

마크다운 코드 블록(`` ``` ``) 내부의 `#`은 heading이 아니므로 변환에서 제외한다.

- `` ``` `` ~ `` ``` `` 사이의 라인은 무조건 스킵
- 인라인 코드(`` ` ``)는 heading 라인 자체에 포함될 수 있으므로 별도 처리 불필요 (heading 시작 `#`과 구분됨)

---

## 3. 렌더링 영향

### 3.1 markdown-renderer.tsx

`src/components/markdown-renderer.tsx`에서 h1~h6 모두 커스텀 렌더러가 정의되어 있어 heading 레벨 변경 시 스타일이 자동 적용된다.

| 레벨 | 클래스 | 크기 |
|------|--------|------|
| h1 | `text-3xl font-bold mb-6 mt-8` | 가장 큼 |
| h2 | `text-2xl font-semibold mb-4 mt-6` | |
| h3 | `text-xl font-semibold mb-3 mt-5` | |
| h4 | `text-lg font-semibold mb-2 mt-4` | |

현재 대부분의 최상위 heading이 `##`(h2, text-2xl)이었으나, 변환 후 `#`(h1, text-3xl)이 되므로 **글씨 크기가 커진다**. 기존 블로그 포스트 상세 페이지에서 frontmatter title이 별도로 렌더링되고 있어, 본문 내 H1 사용은 시각적으로 문제가 될 수 있다.

### 3.2 확인 필요 사항

- 블로그 포스트 상세 페이지에서 frontmatter `title`과 본문 `# 1. 개요`가 시각적으로 충돌하지 않는지 확인
- 필요 시 markdown-renderer의 h1 스타일을 h2와 동일하게 조정하거나, 본문 내 h1은 h2 스타일로 렌더링되도록 처리

---

## 4. 처리 순서

### 단계 1: 렌더링 영향 사전 확인

1개 파일만 변환하여 로컬에서 렌더링 확인 → 스타일 조정 필요 여부 판단

### 단계 2: 카테고리별 변환

파일 수가 적은 카테고리부터 처리:

1. `etc/` (~9개)
2. `etf/` (~11개)
3. `weekly/` (~15개)
4. `stock/` (~58개)

### 단계 3: 검증

- 전체 파일 heading 패턴 일괄 검증
- 빌드 테스트 (`npm run build`)
- 로컬 확인 (`npm run start` + Playwright)
- 인코딩 검증 (`file -I`)
